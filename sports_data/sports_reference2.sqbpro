<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/Tyler Dufrene/Documents/TylerDufrene/Data Science/sports_data/sports_reference.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="150"/><column_width id="3" width="26445"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,15:mainncaaf_all_teams"/><default_encoding codec=""/><browse_table_settings/></tab_browse><tab_sql><sql name="SQL 1">CREATE TABLE ncaaf_team_season_stats as 
select 
        team_team, team_id, team_conference, week_num, id
        , lag(team_points,1,0) over (partition by team_id, season order by id) as team_points, lag(opponent_points,1,0) over (partition by team_id, season order by id) as opponent_points, lag(team_yardsPerRushAttempt,1,0) over (partition by team_id, season order by id) as team_yardsPerRushAttempt, lag(team_yardsPerPass,1,0) over (partition by team_id, season order by id) as team_yardsPerPass, lag(team_turnovers,1,0) over (partition by team_id, season order by id) as team_turnovers, lag(team_totalYards,1,0) over (partition by team_id, season order by id) as team_totalYards, lag(team_totalFumbles,1,0) over (partition by team_id, season order by id) as team_totalFumbles, lag(team_thirdDownEff,1,0) over (partition by team_id, season order by id) as team_thirdDownEff, lag(team_rushingYards,1,0) over (partition by team_id, season order by id) as team_rushingYards, lag(team_rushingTDs,1,0) over (partition by team_id, season order by id) as team_rushingTDs, lag(team_rushingAttempts,1,0) over (partition by team_id, season order by id) as team_rushingAttempts, lag(team_possessionTime,1,0) over (partition by team_id, season order by id) as team_possessionTime, lag(team_passingTDs,1,0) over (partition by team_id, season order by id) as team_passingTDs, lag(team_passesIntercepted,1,0) over (partition by team_id, season order by id) as team_passesIntercepted, lag(team_netPassingYards,1,0) over (partition by team_id, season order by id) as team_netPassingYards, lag(team_kickingPoints,1,0) over (partition by team_id, season order by id) as team_kickingPoints, lag(team_kickReturns,1,0) over (partition by team_id, season order by id) as team_kickReturns, lag(team_kickReturnYards,1,0) over (partition by team_id, season order by id) as team_kickReturnYards, lag(team_kickReturnTDs,1,0) over (partition by team_id, season order by id) as team_kickReturnTDs, lag(team_interceptions,1,0) over (partition by team_id, season order by id) as team_interceptions, lag(team_interceptionYards,1,0) over (partition by team_id, season order by id) as team_interceptionYards, lag(team_interceptionTDs,1,0) over (partition by team_id, season order by id) as team_interceptionTDs, lag(team_fumblesRecovered,1,0) over (partition by team_id, season order by id) as team_fumblesRecovered, lag(team_fumblesLost,1,0) over (partition by team_id, season order by id) as team_fumblesLost, lag(team_fourthDownEff,1,0) over (partition by team_id, season order by id) as team_fourthDownEff, lag(team_firstDowns,1,0) over (partition by team_id, season order by id) as team_firstDowns, lag(team_tacklesForLoss,1,0) over (partition by team_id, season order by id) as team_tacklesForLoss, lag(team_tackles,1,0) over (partition by team_id, season order by id) as team_tackles, lag(team_sacks,1,0) over (partition by team_id, season order by id) as team_sacks, lag(team_qbHurries,1,0) over (partition by team_id, season order by id) as team_qbHurries, lag(team_puntReturns,1,0) over (partition by team_id, season order by id) as team_puntReturns, lag(team_puntReturnYards,1,0) over (partition by team_id, season order by id) as team_puntReturnYards, lag(team_puntReturnTDs,1,0) over (partition by team_id, season order by id) as team_puntReturnTDs, lag(team_passesDeflected,1,0) over (partition by team_id, season order by id) as team_passesDeflected, lag(team_defensiveTDs,1,0) over (partition by team_id, season order by id) as team_defensiveTDs, lag(team_total_penalties,1,0) over (partition by team_id, season order by id) as team_total_penalties, lag(team_total_penalty_yards,1,0) over (partition by team_id, season order by id) as team_total_penalty_yards, lag(team_yards_per_penalty,1,0) over (partition by team_id, season order by id) as team_yards_per_penalty, lag(team_completions,1,0) over (partition by team_id, season order by id) as team_completions, lag(team_completions_attempted,1,0) over (partition by team_id, season order by id) as team_completions_attempted, lag(team_completion_percent,1,0) over (partition by team_id, season order by id) as team_completion_percent, lag(opponent_yardsPerRushAttempt,1,0) over (partition by team_id, season order by id) as opponent_yardsPerRushAttempt, lag(opponent_yardsPerPass,1,0) over (partition by team_id, season order by id) as opponent_yardsPerPass, lag(opponent_turnovers,1,0) over (partition by team_id, season order by id) as opponent_turnovers, lag(opponent_totalYards,1,0) over (partition by team_id, season order by id) as opponent_totalYards, lag(opponent_totalFumbles,1,0) over (partition by team_id, season order by id) as opponent_totalFumbles, lag(opponent_thirdDownEff,1,0) over (partition by team_id, season order by id) as opponent_thirdDownEff, lag(opponent_rushingYards,1,0) over (partition by team_id, season order by id) as opponent_rushingYards, lag(opponent_rushingTDs,1,0) over (partition by team_id, season order by id) as opponent_rushingTDs, lag(opponent_rushingAttempts,1,0) over (partition by team_id, season order by id) as opponent_rushingAttempts, lag(opponent_puntReturns,1,0) over (partition by team_id, season order by id) as opponent_puntReturns, lag(opponent_puntReturnYards,1,0) over (partition by team_id, season order by id) as opponent_puntReturnYards, lag(opponent_puntReturnTDs,1,0) over (partition by team_id, season order by id) as opponent_puntReturnTDs, lag(opponent_possessionTime,1,0) over (partition by team_id, season order by id) as opponent_possessionTime, lag(opponent_passingTDs,1,0) over (partition by team_id, season order by id) as opponent_passingTDs, lag(opponent_passesIntercepted,1,0) over (partition by team_id, season order by id) as opponent_passesIntercepted, lag(opponent_netPassingYards,1,0) over (partition by team_id, season order by id) as opponent_netPassingYards, lag(opponent_kickingPoints,1,0) over (partition by team_id, season order by id) as opponent_kickingPoints, lag(opponent_kickReturns,1,0) over (partition by team_id, season order by id) as opponent_kickReturns, lag(opponent_kickReturnYards,1,0) over (partition by team_id, season order by id) as opponent_kickReturnYards, lag(opponent_kickReturnTDs,1,0) over (partition by team_id, season order by id) as opponent_kickReturnTDs, lag(opponent_interceptions,1,0) over (partition by team_id, season order by id) as opponent_interceptions, lag(opponent_interceptionYards,1,0) over (partition by team_id, season order by id) as opponent_interceptionYards, lag(opponent_interceptionTDs,1,0) over (partition by team_id, season order by id) as opponent_interceptionTDs, lag(opponent_fumblesRecovered,1,0) over (partition by team_id, season order by id) as opponent_fumblesRecovered, lag(opponent_fumblesLost,1,0) over (partition by team_id, season order by id) as opponent_fumblesLost, lag(opponent_fourthDownEff,1,0) over (partition by team_id, season order by id) as opponent_fourthDownEff, lag(opponent_firstDowns,1,0) over (partition by team_id, season order by id) as opponent_firstDowns, lag(opponent_tacklesForLoss,1,0) over (partition by team_id, season order by id) as opponent_tacklesForLoss, lag(opponent_tackles,1,0) over (partition by team_id, season order by id) as opponent_tackles, lag(opponent_sacks,1,0) over (partition by team_id, season order by id) as opponent_sacks, lag(opponent_qbHurries,1,0) over (partition by team_id, season order by id) as opponent_qbHurries, lag(opponent_passesDeflected,1,0) over (partition by team_id, season order by id) as opponent_passesDeflected, lag(opponent_defensiveTDs,1,0) over (partition by team_id, season order by id) as opponent_defensiveTDs, lag(opponent_total_penalties,1,0) over (partition by team_id, season order by id) as opponent_total_penalties, lag(opponent_total_penalty_yards,1,0) over (partition by team_id, season order by id) as opponent_total_penalty_yards, lag(opponent_yards_per_penalty,1,0) over (partition by team_id, season order by id) as opponent_yards_per_penalty, lag(opponent_completions,1,0) over (partition by team_id, season order by id) as opponent_completions, lag(opponent_completions_attempted,1,0) over (partition by team_id, season order by id) as opponent_completions_attempted, lag(opponent_completion_percent,1,0) over (partition by team_id, season order by id) as opponent_completion_percent
        from ncaaf_game_stats_by_team
        where season = 2023;
		
select * from ncaaf_team_season_stats
where team_id = 99;</sql><current_tab id="0"/></tab_sql></sqlb_project>
